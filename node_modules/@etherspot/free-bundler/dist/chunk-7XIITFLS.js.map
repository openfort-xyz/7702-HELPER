{"version":3,"sources":["../src/client.ts"],"sourcesContent":["import type { Account, Chain, Transport } from 'viem'\nimport { createClient, http } from 'viem'\nimport { bundlerActions, SmartAccount } from 'viem/account-abstraction'\n\nimport type { FreeBundlerClient, CreateFreeBundlerOptions } from './types'\nimport { DEFAULT_TRANSPORT_OPTIONS, DEFAULT_CLIENT_OPTIONS } from './config.js'\nimport { getFreeBundlerUrl, validateChainId } from './utils.js'\n\n/**\n * Creates a bundler client with preconfigured free bundler URLs\n * \n * @param chainId - The chain ID to create the bundler client for\n * @param options - Optional configuration overrides\n * @returns A configured viem bundler client\n * \n * @example\n * ```typescript\n * import { createFreeBundler } from '@etherspot/free-bundler'\n * \n * Create bundler client for Ethereum Sepolia\n * const bundlerClient = createFreeBundler(11155111)\n * \n * Create bundler client for Polygon with custom transport options\n * const bundlerClient = createFreeBundler(137, {\n *   transport: {\n *     timeout: 10000,\n *     retryCount: 3\n *   }\n * })\n * \n * Use the bundler client\n * const userOperation = await bundlerClient.sendUserOperation({\n *   userOperation: {\n *     sender: '0x...',\n *     nonce: 0n,\n *     callData: '0x...',\n *     ... other fields\n *   },\n *   entryPoint: '0x...'\n * })\n * ```\n */\nexport function createFreeBundler<\n  chain extends Chain,\n  account extends SmartAccount | undefined = undefined,\n>(\n  options: CreateFreeBundlerOptions<chain, account>\n): FreeBundlerClient<Transport, chain, account> {\n  // Get bundler URL from options or use preconfigured free endpoint\n  const bundlerUrl = options.bundlerUrl || getFreeBundlerUrl(options.chain.id)\n\n  if (!bundlerUrl) {\n    validateChainId(options.chain.id)\n  }\n\n  // Create HTTP transport with configuration\n  const transport = http(bundlerUrl, {\n    timeout: options.transport?.timeout ?? DEFAULT_TRANSPORT_OPTIONS.timeout,\n    retryCount: options.transport?.retryCount ?? DEFAULT_TRANSPORT_OPTIONS.retryCount,\n    retryDelay: options.transport?.retryDelay ?? DEFAULT_TRANSPORT_OPTIONS.retryDelay,\n  })\n\n  // Create the base client\n  const client = createClient({\n    transport,\n    chain: options.chain,\n    account: options.account,\n    name: options.client?.name ?? DEFAULT_CLIENT_OPTIONS.name,\n    pollingInterval: options.client?.pollingInterval ?? DEFAULT_CLIENT_OPTIONS.pollingInterval,\n  })\n\n  // Extend with bundler actions\n  return client.extend(bundlerActions) as FreeBundlerClient<Transport, chain, account>\n}"],"mappings":";;;;;;;;;;AACA,SAAS,cAAc,YAAY;AACnC,SAAS,sBAAoC;AAwCtC,SAAS,kBAId,SAC8C;AAE9C,QAAM,aAAa,QAAQ,cAAc,kBAAkB,QAAQ,MAAM,EAAE;AAE3E,MAAI,CAAC,YAAY;AACf,oBAAgB,QAAQ,MAAM,EAAE;AAAA,EAClC;AAGA,QAAM,YAAY,KAAK,YAAY;AAAA,IACjC,SAAS,QAAQ,WAAW,WAAW,0BAA0B;AAAA,IACjE,YAAY,QAAQ,WAAW,cAAc,0BAA0B;AAAA,IACvE,YAAY,QAAQ,WAAW,cAAc,0BAA0B;AAAA,EACzE,CAAC;AAGD,QAAM,SAAS,aAAa;AAAA,IAC1B;AAAA,IACA,OAAO,QAAQ;AAAA,IACf,SAAS,QAAQ;AAAA,IACjB,MAAM,QAAQ,QAAQ,QAAQ,uBAAuB;AAAA,IACrD,iBAAiB,QAAQ,QAAQ,mBAAmB,uBAAuB;AAAA,EAC7E,CAAC;AAGD,SAAO,OAAO,OAAO,cAAc;AACrC;","names":[]}
